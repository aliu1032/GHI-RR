"0","#select_col <- c(""OLIID"",""Total Billed"",""Total Outstanding"",""Total Payment"",""Revenue"")"
"0","select_col <- c(""OLIID"",""PayorPaid"",""PatientPaid"",""Total Outstanding"")"
"0","OLI_TTXN<-melt(Claim2Rev[,select_col],"
"0","               id.vars=(""OLIID""), variable_name=""TXNType"", value_name=""TXNAmount"")"
"0","setnames(OLI_TTXN,c(""value"",""variable""),c(""TXNAmount"",""TXNTypeDesc""))"
"0","OLI_TTXN <- mutate(OLI_TTXN, TXNCategory = 'Receipts', TXNSubCategory = 'Payment')"
"0","levels(OLI_TTXN$TXNTypeDesc)[match(""Total Outstanding"",levels(OLI_TTXN$TXNTypeDesc))] <- 'Outstanding'"
"0","OLI_TTXN[OLI_TTXN$TXNTypeDesc == 'Outstanding','TXNSubCategory'] <- 'Outstanding'"
"0","# retrieve adjusment transaction"
"0","Adjustment_TTXN <- Pymnt %>%"
"0","                   dplyr::filter(TXNType %in% c('AC','AD')) %>%"
"0","                   group_by_(.dots=c(grp_var,'AdjustmentGroup','GHIAdjustmentCode','CategoryDesc','QDXAdjustmentCode','Description')) %>%"
"0","                   summarize(sum_TXN = sum(TXNAmount))"
"0","setnames(Adjustment_TTXN, c('sum_TXN'),c('TXNAmount'))"
"0","Adjustment_TTXN <- Adjustment_TTXN %>%"
"0","                   mutate(TXNTypeDesc = paste(GHIAdjustmentCode, "":"",CategoryDesc,sep=""""),"
"0","                          TXNCategory = 'Receipts',"
"0","                          TXNSubCategory = 'Adjustment')"
"0","Adjustment_TTXN[Adjustment_TTXN$GHIAdjustmentCode=='GH04','TXNCategory'] <- 'Billing'"
"0","Adjustment_TTXN[Adjustment_TTXN$GHIAdjustmentCode=='GH04','TXNSubCategory'] <- 'Charged in Error'"
"0","Adjustment_TTXN[Adjustment_TTXN$GHIAdjustmentCode=='GH09','TXNSubCategory'] <- 'Payment'"
"0","OLI_TXN <-"
"0","list(OLI_TTXN,"
"0","     Adjustment_TTXN) %>%"
"0","    Reduce(function(dtf1,dtf2) bind_rows(dtf1,dtf2), .)"
"2","binding factor and character vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"0","## adding OLI_Info (w/ Payor)"
"0","OLI_TXN <- OLI_TXN %>%"
"0","           dplyr::filter(TXNAmount != 0.0) %>%"
"0","           dplyr::filter(OLIID!="""") %>%"
"0","           arrange(OLIID)"
"0","select_col <- c('OLIID','Test','TestDeliveredDate'"
"0","                ,'Tier1Payor','Tier2Payor','Tier2PayorID','Tier4Payor','FinancialCategory','LineOfBenefit'"
"0","                ,'TerritoryRegion','OrderingHCPState')"
"0","OLI_TXN <- left_join(OLI_TXN, OLI_info[,select_col], by='OLIID')"
"0","setnames(OLI_TXN, c('FinancialCategory'), c('Financial Category'))"
"0","rm(list = ls()[grep(""*_TTXN*"", ls())])"
