"0","select_col <- c('appealCaseNumber',"
"0","                'A1','A2','A3','A4','A5','ER','L1','L2','L3',"
"0","                'A1_Status','A2_Status','A3_Status','A4_Status','A5_Status','ER_Status','L1_Status','L2_Status','L3_Status')"
"0","Claim2Rev <-  left_join(Claim2Rev, appeal_status_wide[,select_col], by=c('QDXCaseNumber' = 'appealCaseNumber'))"
"0","select_col = c('appealCaseNumber', 'lastappealEntryDt',"
"0","               'LastAppealLevel',"
"0","               'lastappealStatus',"
"0","               'appealDenReasonCode','appealDenReasonDesc')"
"0","Claim2Rev <-  left_join(Claim2Rev, latest_appealLvl[,select_col], by=c('QDXCaseNumber' = 'appealCaseNumber'))"
"0","select_col = c('appealCaseNum','appealSuccess',"
"0","               'appealAmtChg','appealAmtChgExp','appealAmtAllow',"
"0","               'appealAmtClmRec',"
"0","               'appealAmt','appealAmtAplRec',"
"0","               'appealRptDt','appealCurrency')"
"0","Claim2Rev <- left_join(Claim2Rev, complete_appeal[,select_col], by=c('QDXCaseNumber' = 'appealCaseNum'))"
"0","#Claim2Rev_2 <- left_join(Claim2Rev_2, complete_appeal[,col_complete_appeal], by=c('QDXTicketNumber' = 'appealTickNum'))"
"0","## calculate the appealResult"
"0","Claim2Rev[which(Claim2Rev$appealSuccess==1),'appealResult'] <- 'Success'"
"0","Claim2Rev[which(Claim2Rev$appealSuccess==0),'appealResult'] <- 'Failed'"
"0","# Scenario : appealSuccess is null but there is appeal Den Reason -> appeal is in process"
"0","a <- is.na(Claim2Rev$appealSuccess)"
"0","b <- is.na(Claim2Rev$appealDenReason)"
"2","is.na() applied to non-(list or vector) of type 'NULL'"
"0","Claim2Rev[which(a & !b),'appealResult'] <- 'In Process'"
"0","QDX_complete_appeal_status <- c('Completed','Final Review','Due from Patient')"
"0","# if Billing Status is in complete status -> conclude the appeal is removed"
"0","a <- (Claim2Rev$appealResult == 'In Process')"
"0","b <- (Claim2Rev$BillingCaseStatusSummary2 %in% QDX_complete_appeal_status)"
"0","Claim2Rev[which(a & b),'appealResult'] <- 'Removed'"
"0","## 'correct' BillingCaseStatusSummary2"
"0","# Scenario appeal case is open with the current ticket for the OLI, BillignCaseStatusSummary2 is not appeal"
"0","c <- Claim2Rev$BillingCaseStatusSummary2 == 'Appeals'"
"0","Claim2Rev[which(a & !b & !c), 'BillingCaseStatusSummary2'] <- 'Appeals'"
"0","# Scenario appealResult is either success or fail, Billing Status is not in the QDX_complete_appeal_status,"
"0","a <- Claim2Rev$appealResult %in% c('Failed','Success')"
"0","Claim2Rev[which(a & !b),'BillingCaseStatusSummary2'] <- 'Final Review'"
"0","Claim2Rev[which(a & !b),'BillingCaseStatus'] <- 'Final Review'"
"0","a <- is.na(Claim2Rev$appealResult)"
"0","Claim2Rev[which(a & c),'BillingCaseStatusSummary2'] <- 'Claim in Process'"
"0","rm(appeal_status_list)"
