"0","# retrieve billing transactions"
"0","Claim_TTXN <- Claim %>%"
"0","             select (OLIID, TicketNumber, CaseNumber,"
"0","                     Test, OLIDOS,"
"0","                     TXNDate, TXNAcctPeriod, TXNLineNumber, TXNType,"
"0","                     TXNCurrency, TXNAmount)"
"0","setnames(Claim_TTXN, 'OLIDOS','TestDeliveredDate')"
"0","# retrieve payment transactions"
"0","Pymnt_TTXN <- Pymnt %>%"
"0","             dplyr::filter(TXNType %in% c('RI','RP')) %>%"
"0","             select(OLIID, TicketNumber,CaseNumber,"
"0","                    Test, OLIDOS,"
"0","                    TXNDate, TXNAcctPeriod, TXNLineNumber, TXNType,"
"0","                    TXNCurrency, TXNAmount)"
"0","setnames(Pymnt_TTXN, 'OLIDOS','TestDeliveredDate')"
"0","# retrieve adjustment transactions"
"0","Adjustment_TTXN <- Pymnt %>%"
"0","                  dplyr::filter(TXNType %in% c('AC','AD')) %>%"
"0","                  select(OLIID, TicketNumber,CaseNumber,"
"0","                    Test, OLIDOS,"
"0","                    TXNDate, TXNAcctPeriod, TXNLineNumber, TXNType,"
"0","                    TXNCurrency, TXNAmount,"
"0","                    QDXAdjustmentCode, Description, GHIAdjustmentCode, CategoryDesc, AdjustmentGroup)"
"0","setnames(Adjustment_TTXN, 'OLIDOS','TestDeliveredDate')"
"0","# retrieve revenue transactions"
"0","                "
"0","Revenue_TTXN <- data.table::melt(Revenue[,c(grp_var,'AccountingPeriod','AccountingPeriodDate',"
"0","                              'Currency',"
"0","                              'TotalRevenue', 'TotalCashRevenue','TotalAccrualRevenue',"
"0","                              'TotalUSDRevenue','TotalUSDCashRevenue','TotalUSDAccrualRevenue')]"
"0","                   , id=c(grp_var, 'AccountingPeriod','AccountingPeriodDate','Currency'), na.rm=TRUE)"
"0","setnames(Revenue_TTXN,"
"0","         c(""AccountingPeriod"",""AccountingPeriodDate"",""Currency"",""variable"",""value""),"
"0","         c(""TXNAcctPeriod"",""TXNDate"",""TXNCurrency"",""TXNType"",""TXNAmount""))"
"0","Revenue_TTXN$TXNLineNumber <- 0"
"0","Revenue_TTXN <- left_join(Revenue_TTXN, OLI_info[,c('OLIID','Test','TestDeliveredDate')])"
"2","Joining, by = ""OLIID""
"
"0","ClaimTicket_TXN <-"
"0","list(Claim_TTXN"
"0","     ,Pymnt_TTXN"
"0","     ,Adjustment_TTXN"
"0","     ,Revenue_TTXN"
"0","    ) %>%"
"0","    Reduce(function(dtf1,dtf2) bind_rows(dtf1,dtf2), .)"
"2","binding character and factor vector, coercing into character vector"
"0","ClaimTicket_TXN <- ClaimTicket_TXN %>%"
"0","                    dplyr::filter(TXNAmount != 0.0) %>%"
"0","                    #dplyr::filter(TestDeliveredDate >= '2017-06-01' & TestDeliveredDate <= '2017-07-31')%>%"
"0","                    arrange(OLIID, TicketNumber,desc(TXNLineNumber))"
"0","target = 'ClaimTicket_TXN.txt'"
"0","write.table(ClaimTicket_TXN, file = paste(output_folder,target,sep=""""), sep=""|"", row.names=FALSE, col.names=TRUE, na="""")"
"0","target = 'OLIDetail_Tick2_MissingRows.txt'"
"0","write.table(OLIDetail_TICK2, file = paste(output_folder,target,sep=""""), sep=""|"", row.names=FALSE, col.names=TRUE, na="""")"
"2","Error in is.data.frame(x) : object 'OLIDetail_TICK2' not found
"
